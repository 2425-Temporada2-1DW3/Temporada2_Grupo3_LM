<div class="tituloDesplegable">
    <h1>Clasificación</h1>
    <div class="listaTemporada">
        <form action="temporada">
            <select name="temporadas" id="temporada" onchange="actualizarTablaClasificacion()">
                <option value="1">Temporada 1</option>
                <option value="2">Temporada 2</option>
                <option value="3">Temporada 3</option>
            </select>
        </form>
    </div>
</div>

<div id="tablaClasificacion"></div>

<script>
    function cargarClasificacion(xmlUrl, xsltUrl, contenedorId, temporadaSeleccionada) {
        const xhr = new XMLHttpRequest();
        const xsl = new XMLHttpRequest();

        xhr.open("GET", xmlUrl, true);
        xsl.open("GET", xsltUrl, true);

        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                xsl.onreadystatechange = function () {
                    if (xsl.readyState === 4 && xsl.status === 200) {
                        const parser = new DOMParser();
                        const xmlDoc = parser.parseFromString(xhr.responseText, "text/xml");
                        const xsltDoc = parser.parseFromString(xsl.responseText, "text/xml");

                        if (window.ActiveXObject || "ActiveXObject" in window) {
                            const ex = new ActiveXObject("Msxml2.XSLTemplate");
                            const xsltProc = ex.createProcessor();
                            xsltProc.input = xmlDoc;
                            xsltProc.addParameter("temporadaSeleccionada", temporadaSeleccionada);
                            xsltProc.transform();
                            document.getElementById(contenedorId).innerHTML = xsltProc.output;
                        } else {
                            const xsltProcessor = new XSLTProcessor();
                            xsltProcessor.importStylesheet(xsltDoc);
                            xsltProcessor.setParameter(null, "temporadaSeleccionada", temporadaSeleccionada);
                            const resultDocument = xsltProcessor.transformToFragment(xmlDoc, document);
                            const contenedor = document.getElementById(contenedorId);
                            contenedor.innerHTML = ""; // Limpiar contenido previo
                            contenedor.appendChild(resultDocument);
                        }
                    }
                };
                xsl.send();
            }
        };
        xhr.send();
    }

    function actualizarTablaClasificacion() {
        const temporadaSeleccionada = document.getElementById("temporada").value;
        cargarClasificacion('../xmlPrueba/temporada.xml', '../xmlPrueba/clasificacionBuena.xsl', 'tablaClasificacion', temporadaSeleccionada);
    }

    // Cargar la clasificación inicial (primera temporada por defecto)
    actualizarTablaClasificacion();
</script>
